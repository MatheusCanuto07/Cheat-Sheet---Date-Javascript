<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mapa</title>
</head>

<body>
  <div>
    <div style="width: 800px;"><canvas id="myChart"></canvas></div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <script>
    const ctx = document.getElementById('myChart');
    // const plugin = {
    //   id: 'customCanvasBackgroundColor',
    //   beforeDraw: (chart, args, options) => {
    //     const { ctx } = chart;
    //     ctx.save();
    //     ctx.globalCompositeOperation = 'destination-over';
    //     ctx.fillStyle = options.color || '#99ffff';
    //     ctx.fillRect(0, 0, chart.width, chart.height);
    //     ctx.restore();
    //   }
    // };
    // Construtor do gráfico
    new Chart(ctx, {
      type: 'bar',
      // Data : Dados do gráfico -> Legendas e valores das colunas
      data: {
        // Legendas que vão embaixo dos valores
        labels: ['Red', 'Blue', 'Yellow', 'Green', 'Purple', 'Orange'],
        // Valores de fato
        // Se o gráfico tiver 2 conjuntos de dados, tem que passar 2 datasets
        datasets: [
          {
            // Legenda que vai aparecer quando passar o mouse encima
            label: '# of Votes',
            data: [12, 19, 3, 5, 2, 3],
            borderWidth: 1,
            //Porcentagem (0–1) da largura disponível que cada barra deve ocupar dentro da largura da categoria.
            //1.0 vai ocupar toda a largura da categoria e colocar as barras encostadas umas nas outras.
            barPercentage: 0.6,
            // No Chart.js, base define o valor inicial no eixo de valores (y para gráficos verticais, x para gráficos horizontais) de onde a barra começa a ser desenhada.
            // Esse parâmetro aceita um valor fixo, uma lista de valores ou uma função que retorna um valor com base no contexto do gráfico.
            // base: [0, 5, 10] 
            // base: 5
            // base: (context) => {
            //   // Exemplo: começa em 5 para índices pares, 0 para ímpares
            //   console.log(context)
            //   return context.dataIndex % 2 === 0 ? 5 : 0;
            // }
            borderRadius: 10,
            hoverBackgroundColor: 'green',
            backgroundColor: "blue",
          },
          {
            // Legenda que vai aparecer quando passar o mouse encima
            label: '# of Votes',
            data: [12 + 9, 19, 3, 5, 2],
            borderWidth: 1
          }
        ]
      },
      // Options do gráfico
      options: {
        scales: {
          x: {
            title: {
              display: true,
              text: "Motoboys",
              size: 18,
              font: {
                weight: 'bold',
              }
            },
            border: {
              display: true
            },
            grid: {
              display: true,
              drawOnChartArea: true,
              drawTicks: true,
            },
            color: {
              backgroundColor: '#000000'
            }
          },
          y: {
            title: {
              display: true,
              text: "Valor faturado",
              size: 18,
              font: {
                weight: 'bold',
              }
            },
            beginAtZero: true,
            grid: {
              display: true
            },
            ticks: {
              callback: function (value) {
                return value.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
              }
            }
          }
        },
        onClick: (event, elements, chart) => {
          if (elements[0]) {
            const i = elements[0].index;
            alert(chart.data.labels[i] + ': ' + chart.data.datasets[0].data[i]);
          }
        },
        plugins: {
          tooltip: {
            callbacks: {
              label: (context) => {
                let value = context.raw;
                const formatado = value.toLocaleString('pt-BR', {
                  style: 'currency',
                  currency: 'BRL'
                });
                return formatado + " unidades";
              }
            }
          },
          // customCanvasBackgroundColor: {
          //   color: 'lightGreen',
          // },
          title: {
            text: "Teste de título",
            font: {
              size: 26,
              weight: 'bold'
            },
            display: true
          },
          legend: {
            display: true,
            title: {
              text: "Isso daqui é um exemplo de legenda",
              display: true,
              font: {
                size: 12,
              }
            },
            position: 'top'
          }
        },
      },
      //plugins: [plugin],
    });
  </script>
</body>

</html>